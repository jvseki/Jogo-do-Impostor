<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="/static/style.css">
<title>Jogo do Impostor</title>
</head>
<body>

<div class="container">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
        <h1>üé≠ Jogo do Impostor</h1>
        <button type="button" onclick="resetarTudo()" style="background:none; border:none; font-size:20px; cursor:pointer;" title="Limpar dados">
            üóëÔ∏è
        </button>
    </div>

    <form method="post" action="/comecar" onsubmit="salvarDados()">

        <div id="players"></div>

        <div class="player-controls">
            <button type="button" class="btn-circle" onclick="addPlayer()">+</button>
            <button type="button" class="btn-circle danger" onclick="removePlayer()">‚àí</button>
        </div>

        <h2>Modo</h2>
        <select name="modo" id="modoSelect" onchange="toggleTema(this.value)">
            <option value="classico">Cl√°ssico</option>
            <option value="personalizado">Personalizado</option>
        </select>

        <div id="temaBox" style="display:none">
            <textarea name="temas" id="temasInput" placeholder="Temas separados por v√≠rgula"></textarea>
        </div>

        <h2>Impostores</h2>
        <select name="impostores" id="impostoresSelect" onchange="validarImpostor(this.value)">
            <option value="1">1 Impostor</option>
            <option value="2">2 Impostores</option>
        </select>

        <button class="btn start-btn">‚ñ∂Ô∏è Come√ßar Solo</button>
    </form>

    <hr style="margin: 20px 0; border: 0; border-top: 1px solid #444;">
    
    <button type="button" onclick="avisoOnline()" class="btn" style="background: linear-gradient(135deg, #00d4ff 0%, #0055ff 100%); color: white; border: none; font-weight: bold;">
        üåç JOGAR ONLINE (BETA)
    </button>
</div>

<script>
    // ===== FUN√á√ÉO DO ALERTA ONLINE QUE VOC√ä PEDIU =====
    function avisoOnline() {
        const mensagem = 
`‚ö†Ô∏è MODO ONLINE - LEIA COM ATEN√á√ÉO ‚ö†Ô∏è

Bem-vindo ao modo Multiplayer!

1. ERROS PODEM OCORRER: O modo ainda est√° em testes.
2. COMUNICA√á√ÉO: O jogo N√ÉO tem √°udio. Use Discord, WhatsApp ou jogue presencialmente.
3. COMO JOGAR:
   - O L√çDER (üëë) cria a sala e inicia a partida.
   - O tema aparece na tela de cada um.
   - O L√≠der clica em "Ir para Discuss√£o" e a roleta sorteia quem fala primeiro.
   - Voc√™s debatem na vida real e votam.

Deseja continuar?`;

        if(confirm(mensagem)) {
            window.location.href = "/online";
        }
    }

    // ===== SEU SCRIPT ORIGINAL DO MODO SOLO (MANTIDO) =====
    let players = ["", "", ""];

    function render() {
        const div = document.getElementById("players");
        div.innerHTML = "";
        players.forEach((p, i) => {
            div.innerHTML += `<input name="jogadores" value="${p}" placeholder="Jogador ${i+1}" required 
            oninput="atualizarNome(${i}, this.value)">`;
        });
    }

    function atualizarNome(index, valor) {
        players[index] = valor;
        salvarDados();
    }

    function addPlayer() {
        if (players.length < 15) {
            players.push("");
            render();
            salvarDados();
        }
    }

    function removePlayer() {
        if (players.length > 3) {
            players.pop();
            render();
            salvarDados();
        }
    }

    function toggleTema(v) {
        document.getElementById("temaBox").style.display = v === "personalizado" ? "block" : "none";
        salvarDados();
    }

    function validarImpostor(v) {
        if (v == 2 && players.length < 7) {
            alert("üö´ Para 2 impostores √© necess√°rio no m√≠nimo 7 jogadores");
            document.getElementById("impostoresSelect").value = "1";
        }
        salvarDados();
    }

    function salvarDados() {
        const dados = {
            listaJogadores: players,
            modo: document.getElementById("modoSelect").value,
            temas: document.getElementById("temasInput").value,
            qtdImpostores: document.getElementById("impostoresSelect").value
        };
        localStorage.setItem("impostorData", JSON.stringify(dados));
    }

    function carregarDados() {
        const dadosSalvos = localStorage.getItem("impostorData");
        if (dadosSalvos) {
            const dados = JSON.parse(dadosSalvos);
            if (dados.listaJogadores && dados.listaJogadores.length > 0) {
                players = dados.listaJogadores;
                while (players.length < 3) players.push(""); 
            }
            if (dados.modo) {
                document.getElementById("modoSelect").value = dados.modo;
                toggleTema(dados.modo);
            }
            if (dados.temas) {
                document.getElementById("temasInput").value = dados.temas;
            }
            if (dados.qtdImpostores) {
                document.getElementById("impostoresSelect").value = dados.qtdImpostores;
            }
        }
    }

    function resetarTudo() {
        if(confirm("Deseja limpar todos os nomes e configura√ß√µes?")) {
            localStorage.removeItem("impostorData");
            location.reload();
        }
    }

    carregarDados();
    render();
</script>
</body>
</html>